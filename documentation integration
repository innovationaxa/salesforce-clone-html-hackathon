==========================================
DOCUMENTATION Dâ€™INTÃ‰GRATION
data.json â‡„ app.js â‡„ index.html

OBJECTIF ET ARCHITECTURE

But : rendre la page index.html dynamique Ã  partir dâ€™un fichier de donnÃ©es data.json, produit par le back-end (peu importe le langage).

Principe :

index.html contient la structure (sections, cartes, champsâ€¦)

app.js lit data.json et met Ã  jour le contenu de la page

le back met Ã  jour data.json ou renvoie un JSON via une route (ex : /api/dashboard)

Arborescence :
/
â”œâ”€ index.html (structure et composants)
â”œâ”€ styles.css (style)
â”œâ”€ app.js (logique dynamique)
â””â”€ data.json (donnÃ©es mÃ©tier)

Flux des donnÃ©es :

app.js fait un fetch("./data.json")

Il lit le JSON et appelle des fonctions render*

Chaque render met Ã  jour une partie du DOM de index.html

SCHÃ‰MA COMPLET DU FICHIER data.json

Exemple complet de data.json :

{
"profile": {
"segment_label": "Cadre Entreprise",
"chips": [
"ğŸ‚ 41 ans",
"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ MariÃ©e, 2 enfants",
"ğŸ“ Lasseube (64)",
"ğŸ¡ + rÃ©sidence Biarritz"
]
},
"stats": {
"anciennete": 22,
"score": 3,
"incidents": 0
},
"kyc": {
"completeness_pct": 50,
"missing_docs_title": "ğŸ“‹ PiÃ¨ces d'identitÃ© obligatoires Ã  collecter",
"missing_docs": ["CNI Mme Dupont (recto/verso)", "Justificatif de domicile < 3 mois"]
},
"sections": {
"contrats": { "auto": 1, "habitation": 2, "banque": 2 },
"profil": {
"fidelite": "TrÃ¨s fidÃ¨le",
"incidents": "Aucun",
"potentiel": "Ã‰levÃ©"
},
"interactions": {
"last_event": "Sinistre Auto (mai 2025) â€“ Accrochage mineur, rÃ©parÃ© via SAD.",
"satisfaction": 4.5
}
},
"life_moments": [
"ğŸ‘¶ Enfants jeunes adultes",
"ğŸ¡ RÃ©sidence secondaire rÃ©cente"
],
"discovery_questions": [
"Â« Comment envisagez-vous l'avenir de vos enfants ? Â»",
"Â« Avez-vous pensÃ© Ã  sÃ©curiser votre rÃ©sidence secondaire ? Â»"
],
"recommendations": [
{
"title": "Assurance Vie Ã‰pargne",
"score": 8,
"blurb": "Cadre avec capacitÃ© d'Ã©pargne, moment idÃ©al pour prÃ©parer transmission.",
"prep_bullets": [
"Avantages fiscaux attractifs : Jusqu'Ã  152 500â‚¬ exonÃ©rÃ©s par bÃ©nÃ©ficiaire.",
"Rendement compÃ©titif : Performance moyenne de 3,2% en 2024.",
"DisponibilitÃ© des fonds : Rachat possible sans pÃ©nalitÃ© aprÃ¨s 8 ans."
],
"live_bullets": [
"Avantages fiscaux transmission",
"Rendement 3,2% en 2024",
"Disponible aprÃ¨s 8 ans"
]
}
],
"call": {
"duration": "00:05:36",
"summary": "- Demande de justificatif : copie de la carte d'identitÃ© de Mme Dupont\n- Mme Dupont souhaite souscrire un nouveau contrat auto\n- Relancer Mme Dupont lundi pour finaliser la proposition"
}
}

DÃ‰TAIL PAR SECTION DU JSON

PROFILE

segment_label : texte affichÃ© au-dessus des puces

chips : liste des puces affichÃ©es (Ã¢ge, famille, rÃ©sidenceâ€¦)

Mapping :

p.muted â†’ segment_label

ul.chips â†’ chaque entrÃ©e du tableau chips

STATS

anciennete : chiffre affichÃ© dans â€œAnciennetÃ©â€

score : chiffre affichÃ© dans â€œScore fidÃ©litÃ©â€

incidents : nombre dâ€™incidents (0 = success)

Mapping :

1re stat-value = anciennete

2e stat-value = score

3e stat-value = incidents

KYC

completeness_pct : pourcentage de complÃ©tude (0 Ã  100)

missing_docs_title : titre de la section

missing_docs : liste des documents manquants

Mapping :

strong â†’ "âš ï¸ ComplÃ©tude KYC : XX%"

p â†’ titre et dÃ©tail des documents manquants

SECTIONS.CONTRATS

auto, habitation, banque : nombre de contrats actifs

Mapping :

â€œğŸ  Contratsâ€ â†’ â€œContrats actifs : X Auto â€¢ Y Habitation â€¢ Z Banqueâ€

SECTIONS.PROFIL

fidelite : ex â€œTrÃ¨s fidÃ¨leâ€

incidents : ex â€œAucunâ€

potentiel : ex â€œÃ‰levÃ©â€

Mapping :

â€œğŸ§‘ Profilâ€ â†’ contenu HTML gÃ©nÃ©rÃ© dynamiquement

SECTIONS.INTERACTIONS

last_event : dernier Ã©vÃ©nement texte

satisfaction : note de satisfaction (ex 4.5/5)

Mapping :

â€œğŸ’¬ DerniÃ¨res interactionsâ€ â†’ texte + â€œSatisfaction : X/5â€

LIFE_MOMENTS

Liste de puces sur les moments de vie dÃ©tectÃ©s

Mapping :

ul.chips (dans â€œMoments de vie dÃ©tectÃ©sâ€)

DISCOVERY_QUESTIONS

Liste de questions affichÃ©es dans â€œQuestions de dÃ©couverteâ€

Mapping :

Remplace les <p> de cette section

RECOMMENDATIONS
Chaque objet reprÃ©sente une carte :

title : titre de la recommandation

score : note de 0 Ã  10 (dÃ©termine le style du badge)

blurb : courte phrase descriptive

prep_bullets : liste des points clÃ©s â€œPrÃ©parationâ€

live_bullets : liste des points â€œLiveâ€

Mapping :

Chaque entrÃ©e â†’ un <article class="recommendation">

Le compteur â€œRecommandations (X)â€ est calculÃ© automatiquement

CALL

duration : durÃ©e affichÃ©e dans â€œDurÃ©e de lâ€™appelâ€

summary : texte insÃ©rÃ© dans le champ de notes conseiller

Mapping :

span.strong â†’ duration

textarea#ai-summary-text â†’ summary

EMAIL CONTENT (checkboxes)
Quand on coche/dÃ©coche les cases :

â€œDocuments requisâ€ â†’ ajoute la liste des missing_docs

â€œRecommandations personnalisÃ©esâ€ â†’ ajoute les titres des recommandations

â€œRÃ©capitulatif opportunitÃ©sâ€ â†’ ajoute les compteurs des contrats actifs

Ces blocs sont ajoutÃ©s dans le textarea des notes.

SPÃ‰CIFICATION TECHNIQUE (TYPES)

TypeScript (pour rÃ©fÃ©rence) :

type DataJson = {
profile: {
segment_label: string;
chips: string[];
};
stats: {
anciennete: number;
score: number;
incidents: number;
};
kyc: {
completeness_pct: number;
missing_docs_title?: string;
missing_docs?: string[];
};
sections: {
contrats: { auto: number; habitation: number; banque: number; };
profil: { fidelite: string; incidents: string; potentiel: string; };
interactions: { last_event: string; satisfaction: number; };
};
life_moments: string[];
discovery_questions: string[];
recommendations: Array<{
title: string;
score: number;
blurb?: string;
prep_bullets?: string[];
live_bullets?: string[];
}>;
call: {
duration: string;
summary: string;
};
};

RÃˆGLES DE FORMAT ET BONNES PRATIQUES

Nombres : number

Pourcentage : 0 Ã  100

Scores : 0 Ã  10

DurÃ©e : chaÃ®ne â€œHH:MM:SSâ€

Dates futures : format ISO (YYYY-MM-DDTHH:mm:ssZ)

Champs optionnels : peuvent Ãªtre omis (le front affiche â€œâ€”â€)

COMPORTEMENT CÃ”TÃ‰ FRONT (app.js)

Rechargement des sections sans doublons (idempotent)

Ajout automatique de la classe â€œsuccessâ€ si incidents = 0

Badge de recommandation selon le score :

=8 â†’ success
6â€“7 â†’ warning
<6 â†’ info

Les cases Ã  cocher injectent ou suppriment des blocs textuels dans le textarea

Les listes (chips, recos, etc.) sont rÃ©gÃ©nÃ©rÃ©es Ã  chaque appel

CONSIGNES POUR LES DÃ‰VELOPPEURS BACK

Retourner un JSON conforme au schÃ©ma ci-dessus.

Toujours inclure au minimum :

profile.segment_label

profile.chips[]

stats (anciennete, score, incidents)

kyc.completeness_pct

sections (contrats, profil, interactions)

life_moments[]

discovery_questions[]

recommendations[]

call.duration et call.summary

Le fichier ou endpoint doit renvoyer un JSON valide UTF-8.

Autoriser CORS si le front nâ€™est pas servi depuis le mÃªme domaine.

FrÃ©quence de mise Ã  jour libre (toutes les X secondes ou Ã  la demande).

Pour le test, placer data.json Ã  la racine du projet et ouvrir index.html.

TESTS RAPIDES

Ouvrir index.html et vÃ©rifier :
â€¢ Les puces du profil sont remplacÃ©es
â€¢ Les chiffres des stats sont mis Ã  jour
â€¢ Le pourcentage KYC est correct
â€¢ Les contrats / profil / interactions sont actualisÃ©s
â€¢ Les moments de vie et questions apparaissent
â€¢ Les recommandations se rÃ©gÃ©nÃ¨rent avec le bon nombre
â€¢ La durÃ©e et le rÃ©sumÃ© sont affichÃ©s
â€¢ Les cases Ã  cocher ajoutent des blocs dans le rÃ©sumÃ©

RÃ‰SUMÃ‰ DU CONTRAT Dâ€™API Ã€ TRANSMETTRE AUX Ã‰QUIPES BACK

Le fichier ou endpoint JSON doit fournir :

{
profile: {
segment_label: string,
chips: string[]
},
stats: {
anciennete: number,
score: number,
incidents: number
},
kyc: {
completeness_pct: number,
missing_docs_title?: string,
missing_docs?: string[]
},
sections: {
contrats: { auto, habitation, banque },
profil: { fidelite, incidents, potentiel },
interactions: { last_event, satisfaction }
},
life_moments: string[],
discovery_questions: string[],
recommendations: [
{
title: string,
score: number,
blurb?: string,
prep_bullets?: string[],
live_bullets?: string[]
}
],
call: {
duration: string,
summary: string
}
}

FIN DU DOCUMENT
